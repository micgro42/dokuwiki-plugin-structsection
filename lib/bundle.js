(()=>{"use strict";jQuery((function(){jQuery("#plugin__structsection_output").find(".editbutton_table").remove(),jQuery("#plugin__structsection_output").on("submit","form.btn_secedit",(function(e){e.preventDefault(),e.stopPropagation();var t=jQuery(this).parent().prev().find("div.level2"),i=JSINFO.id,n=t.data("struct"),p=JSINFO.plugin_structsection.rev;if(i&&n){var u=jQuery('<div class="struct_inlineditor"><form></form><div class="err"></div></div>'),r=u.find("form"),a=u.find("div.err").hide(),d=jQuery('<button type="submit">Save</button>'),l=jQuery("<button>Cancel</button>");r.append(jQuery('<input type="hidden" name="pid">').val(i)),r.append(jQuery('<input type="hidden" name="field">').val(n)),r.append(jQuery('<input type="hidden" name="rid">').val(0)),r.append(jQuery('<input type="hidden" name="rev">').val(p)),r.append('<input type="hidden" name="call" value="plugin_struct_inline_save">'),r.append(jQuery('<div class="ctl">').append(d).append(l)),jQuery.post(DOKU_BASE+"lib/exe/ajax.php",{call:"plugin_struct_inline_editor",pid:i,field:n,rid:0,rev:p},(function(e){e&&(r.prepend(e),t.closest(".dokuwiki").append(u),u.position({my:"left top",at:"left top",of:t}),r.find("input, textarea").first().focus())})),r.submit((function(e){e.preventDefault(),jQuery.post(DOKU_BASE+"lib/exe/ajax.php",r.serialize()).done((function(e){var i=JSON.parse(e);t.html(i.value),JSINFO.plugin_structsection.rev=i.rev,u.remove()})).fail((function(e){a.text(e.responseText).show()}))})),l.click((function(e){jQuery.post(DOKU_BASE+"lib/exe/ajax.php",{call:"plugin_struct_inline_cancel",pid:i}),e.preventDefault(),u.remove()}))}}))}))})();